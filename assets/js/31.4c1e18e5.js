(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{308:function(t,a,s){"use strict";s.r(a);var n=s(0),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"javascript的运行机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript的运行机制"}},[t._v("#")]),t._v(" JavaScript的运行机制")]),t._v(" "),s("ul",[s("li",[t._v("作用域链本质上是如何产生的")]),t._v(" "),s("li",[t._v("this是如何绑定的")]),t._v(" "),s("li",[t._v("JavaScript运行的原理是什么")]),t._v(" "),s("li",[t._v("闭包产生的基本原因")])]),t._v(" "),s("h2",{attrs:{id:"javascript的执行环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript的执行环境"}},[t._v("#")]),t._v(" JavaScript的执行环境")]),t._v(" "),s("p",[t._v("赋予一段代码意义的正是JavaScript引擎，目前JavaScript引擎有许多种:")]),t._v(" "),s("ul",[s("li",[t._v("V8 — 开源，由 Google 开发，用 C ++ 编写")]),t._v(" "),s("li",[t._v("Rhino — 由 Mozilla 基金会管理，开源，完全用 Java 开发")]),t._v(" "),s("li",[t._v("SpiderMonkey — 是第一个支持 Netscape Navigator 的 JavaScript 引擎，目前正供 Firefox 使用")]),t._v(" "),s("li",[t._v("JavaScriptCore — 开源，以Nitro形式销售，由苹果为Safari开发")]),t._v(" "),s("li",[t._v("KJS — KDE 的引擎，最初由 Harri Porten 为 KDE 项目中的 Konqueror 网页浏览器开发")]),t._v(" "),s("li",[t._v("Chakra (JScript9) — Internet Explorer")]),t._v(" "),s("li",[t._v("Chakra (JavaScript) — Microsoft Edge")]),t._v(" "),s("li",[t._v("Nashorn, 作为 OpenJDK 的一部分，由 Oracle Java 语言和工具组编写")]),t._v(" "),s("li",[t._v("JerryScript —  物联网的轻量级引擎")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiaomuzhu-image.oss-cn-beijing.aliyuncs.com/27d902eae39383d1e92d05f4be51ce9b.png",alt:"2019-06-19-13-00-37"}})]),t._v(" "),s("h2",{attrs:{id:"v8引擎的两个主要组成部分："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#v8引擎的两个主要组成部分："}},[t._v("#")]),t._v(" v8引擎的两个主要组成部分：")]),t._v(" "),s("ul",[s("li",[t._v("emory Heap(内存堆) — 内存分配地址的地方")]),t._v(" "),s("li",[t._v("Call Stack(调用堆栈) — 代码执行的地方")])]),t._v(" "),s("h2",{attrs:{id:"javascript运行时-javascript-runtime"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript运行时-javascript-runtime"}},[t._v("#")]),t._v(" JavaScript运行时(JavaScript Runtime)")]),t._v(" "),s("p",[t._v("JavaScript Engine的工作是编译并执行js代码，完成内存分配、垃圾回收等，但缺乏与外部交互能力，比如单靠一个v8引擎是无法进行ajax请求、设置定时器、响应时间等操作，需要js运行时(JavaScript Runtime)的帮助，它为javascript提供了一些对象或机制，使它能够与外界交互。"),s("br"),t._v("\n虽然Chrome和node都使用了v8引擎，但他们的运行时却不同，比如process、fs浏览器都无法提供")]),t._v(" "),s("h2",{attrs:{id:"可执行代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#可执行代码"}},[t._v("#")]),t._v(" 可执行代码")]),t._v(" "),s("p",[t._v("一段js代码我们可以分为两个阶段：")]),t._v(" "),s("ul",[s("li",[t._v("编译间断：\n"),s("ul",[s("li",[t._v("分词/词法分析(Tokenizing/Lexing)")]),t._v(" "),s("li",[t._v("解析/语法分析(Parsing)")]),t._v(" "),s("li",[t._v("预编译(解释)")])])]),t._v(" "),s("li",[t._v("执行阶段")])]),t._v(" "),s("p",[t._v("javascript并非简单的一行行解析执行，而是将javascript代码分为一块块可执行代码进行执行"),s("br"),t._v("\n目前三类代码块")]),t._v(" "),s("ul",[s("li",[t._v("函数代码块(Function code)")]),t._v(" "),s("li",[t._v("全局代码块(Global code)")]),t._v(" "),s("li",[t._v("eval代码块(Eval code)")])]),t._v(" "),s("h2",{attrs:{id:"javascript执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript执行"}},[t._v("#")]),t._v(" javascript执行")]),t._v(" "),s("p",[t._v("eg:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cxk'")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("say")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" like sining dancing and rap")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"堆"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#堆"}},[t._v("#")]),t._v(" 堆")]),t._v(" "),s("ul",[s("li",[t._v("emory Heap(内存堆) 内存分配的地方")]),t._v(" "),s("li",[t._v("Call Stack(调用栈) 代码执行的地方")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiaomuzhu-image.oss-cn-beijing.aliyuncs.com/65c06e0194c7f94e7af45e8fcb30e004.png",alt:"2019-06-20-00-15-33"}})]),t._v(" "),s("p",[t._v("那么执行name函数，会发生什么？")]),t._v(" "),s("h3",{attrs:{id:"调用栈"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调用栈"}},[t._v("#")]),t._v(" 调用栈")]),t._v(" "),s("p",[t._v("我们生命的函数与变量被存储到"),s("strong",[t._v("内存堆")]),t._v("中，而我们要执行时，就必须借助于"),s("strong",[t._v("调用栈")])]),t._v(" "),s("h3",{attrs:{id:"执行上下文-execution-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文-execution-context"}},[t._v("#")]),t._v(" 执行上下文(execution context)")]),t._v(" "),s("h4",{attrs:{id:"javascript的三种执行上下文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript的三种执行上下文"}},[t._v("#")]),t._v(" javascript的三种执行上下文")]),t._v(" "),s("ul",[s("li",[t._v("全局执行上下文--这是基础上下文，任何不在函数内部的代码都可以在全局上下文中。\n"),s("ul",[s("li",[t._v("创建window对象，并且设置this的值等于这个全局对象。")]),t._v(" "),s("li",[t._v("一个程序只有一个执行上下文")])])]),t._v(" "),s("li",[t._v("函数上下文--每当一个函数被调用时，都会为该函数创建一个新的上下文。每个函数都有自己的上下文，不过函数被调用时创建。函数上下文可以有任意多个，")]),t._v(" "),s("li",[t._v("Eval执行上下文--执行在eval内部的代码会有属于自己的执行上下文，")])]),t._v(" "),s("h3",{attrs:{id:"执行上下文分为两个阶段："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文分为两个阶段："}},[t._v("#")]),t._v(" 执行上下文分为两个阶段：")]),t._v(" "),s("ul",[s("li",[t._v("创建阶段")]),t._v(" "),s("li",[t._v("执行阶段")])]),t._v(" "),s("h4",{attrs:{id:"执行上下文的创建阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行上下文的创建阶段"}},[t._v("#")]),t._v(" 执行上下文的创建阶段")]),t._v(" "),s("ul",[s("li",[t._v("决定this的指向")]),t._v(" "),s("li",[t._v("创建词法环境(LexicalEnvironment)")]),t._v(" "),s("li",[t._v("创建变量环境(VariableEnvironment)")])]),t._v(" "),s("p",[t._v("伪代码如下：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("ExecutionContext "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  ThisBinding "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  LexicalEnvironment "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  VariableEnvironment "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"this指向"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#this指向"}},[t._v("#")]),t._v(" this指向")]),t._v(" "),s("p",[t._v("指向最后一个调用他的人，默认情况下this指向全局对象，比如window，此外可能存在隐式绑定情况，比如通过对象调用函数, eg:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" obj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Messi'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  f"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" f\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//被调用的位置是obj所拥有 所以是Messi")]),t._v("\n")])])]),s("h4",{attrs:{id:"词法环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#词法环境"}},[t._v("#")]),t._v(" 词法环境")]),t._v(" "),s("ul",[s("li",[t._v("全局环境")]),t._v(" "),s("li",[t._v("模块环境")]),t._v(" "),s("li",[t._v("函数环境")])]),t._v(" "),s("h4",{attrs:{id:"词法环境本身包括两个部分："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#词法环境本身包括两个部分："}},[t._v("#")]),t._v(" 词法环境本身包括两个部分：")]),t._v(" "),s("ul",[s("li",[t._v("环境记录器是存储变量和函数声明的实际位置\n"),s("ul",[s("li",[t._v("声明式环境记录器(DecarativeEnvironmentRecord)：范围包含函数定义，变量声明，try...catch，此类型对应其范围内包含的声明定义的标识符集")]),t._v(" "),s("li",[t._v("对象式环境记录器(ObjectEnvironment): 由程序级别(Program)对象、声明、with语句创建，与称为其绑定对象的对象相冠梁，此类型对应于其绑定对象的属性名称的字符串标识符名称集")])])]),t._v(" "),s("li",[t._v("外部环境引用是指它可以访问其父级词法环境")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiaomuzhu-image.oss-cn-beijing.aliyuncs.com/f2fd3a92e2aa96c5005d525389834a57.png",alt:"2019-06-20-03-49-33"}})]),t._v(" "),s("h4",{attrs:{id:"变量环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#变量环境"}},[t._v("#")]),t._v(" 变量环境")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cxk'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("say")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bgm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jntm'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" content "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" like singing dancing and rap, ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("bgm"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" content\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" content "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("say")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ol",[s("li",[t._v("变量name和函数声明say被白存在堆中")]),t._v(" "),s("li",[t._v("创建全局可执行上下文")]),t._v(" "),s("li",[t._v("创建函数执行上下文")]),t._v(" "),s("li",[t._v("创建say函数体内的函数执行上下文")]),t._v(" "),s("li",[t._v("开始执行")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://xiaomuzhu-image.oss-cn-beijing.aliyuncs.com/0f1701f3b7061942ae24a9357f28bc2e.png",alt:"2019-06-20-06-00-27"}})]),t._v(" "),s("h3",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[t._v("#")]),t._v(" 小结")]),t._v(" "),s("h4",{attrs:{id:"this是怎么绑定的？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#this是怎么绑定的？"}},[t._v("#")]),t._v(" this是怎么绑定的？")]),t._v(" "),s("p",[t._v("在创建可执行上下文的时候，根据代码的执行条件，来判断分别进行默认绑定、隐式绑定、显示绑定等。")]),t._v(" "),s("h4",{attrs:{id:"作用域链是怎么形成的？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#作用域链是怎么形成的？"}},[t._v("#")]),t._v(" 作用域链是怎么形成的？")]),t._v(" "),s("p",[t._v("可执行上下文中的词法环境中含有外部词法环境的引用，我们可以通过这个引用获取外部词法环境的变量、声明等，这些引用串联起来一直指向全局的词法环境，因此形成了作用域链。")]),t._v(" "),s("h4",{attrs:{id:"闭包是怎么形成的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包是怎么形成的"}},[t._v("#")]),t._v(" 闭包是怎么形成的")]),t._v(" "),s("p",[t._v("可执行上下文的词法环境中含有外部词法环境的引用，我们可以通过这个引用获取外部词法环境的变量、声明等，因此形成了闭包。")])])}),[],!1,null,null,null);a.default=r.exports}}]);